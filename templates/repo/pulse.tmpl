{{template "base/head" .}}
<div class="repository commits">
	{{template "repo/header" .}}
	<div class="ui container">
		<h2 class="ui header">{{.DateFrom}} - {{.DateTill}}
			<div class="ui right">
				<!-- Period -->
				<div class="ui floating dropdown jump filter">
					<div class="ui basic compact button">
						<span class="text">
							{{.i18n.Tr "repo.pulse.period.filter_label"}} <strong>{{.PeriodText}}</strong>
							<i class="dropdown icon"></i>
						</span>
					</div>
					<div class="menu">
						<a class="{{if eq .Period "daily"}}active {{end}}item" href="{{$.RepoLink}}/pulse/daily">{{.i18n.Tr "repo.pulse.period.daily"}}</a>
						<a class="{{if eq .Period "halfweekly"}}active {{end}}item" href="{{$.RepoLink}}/pulse/halfweekly">{{.i18n.Tr "repo.pulse.period.halfweekly"}}</a>
						<a class="{{if eq .Period "weekly"}}active {{end}}item" href="{{$.RepoLink}}/pulse/weekly">{{.i18n.Tr "repo.pulse.period.weekly"}}</a>
						<a class="{{if eq .Period "monthly"}}active {{end}}item" href="{{$.RepoLink}}/pulse/monthly">{{.i18n.Tr "repo.pulse.period.monthly"}}</a>
					</div>
				</div>
			</div>
		</h2>
		<div class="ui divider"></div>

		{{if (or (.Repository.UnitEnabled $.UnitTypeIssues) (.Repository.UnitEnabled $.UnitTypePullRequests))}}
		<h4 class="ui top attached header">{{.i18n.Tr "repo.pulse.overview"}}</h4>
		<div class="ui attached segment two column grid">
			{{if .Repository.UnitEnabled $.UnitTypePullRequests}}
				<div class="column">
					{{if gt .Pulse.ActivePRCount 0}}
					<div class="table">
						<a href="#merged-pull-requests" class="table-cell tiny background purple" style="width: {{.Pulse.MergedPRPerc}}%"></a>
						<a href="#proposed-pull-requests" class="table-cell tiny background green"></a>
					</div>
					{{end}}
					{{.i18n.Tr "repo.pulse.active_prs_count" .Pulse.ActivePRCount | Safe}}
				</div>
			{{end}}
			{{if .Repository.UnitEnabled $.UnitTypeIssues}}
				<div class="column">
					{{if gt .Pulse.ActiveIssueCount 0}}
					<div class="table">
						<a href="#closed-issues" class="table-cell tiny background red" style="width: {{.Pulse.ClosedIssuePerc}}%"></a>
						<a href="#new-issues" class="table-cell tiny background green"></a>
					</div>
					{{end}}
					{{.i18n.Tr "repo.pulse.active_issues_count" .Pulse.ActiveIssueCount | Safe}}
				</div>
			{{end}}
		</div>
		<div class="ui attached segment horizontal segments">
			{{if .Repository.UnitEnabled $.UnitTypePullRequests}}
				<a href="#merged-pull-requests" class="ui attached segment text center">
					<i class="text purple octicon octicon-git-pull-request"></i> <strong>{{.Pulse.MergedPRCount}}</strong><br>
					{{.i18n.Tr "repo.pulse.merged_prs_count"}}
				</a>
				<a href="#proposed-pull-requests" class="ui attached segment text center">
					<i class="text green octicon octicon-git-branch"></i> <strong>{{.Pulse.OpenedPRCount}}</strong><br>
					{{.i18n.Tr "repo.pulse.opened_prs_count"}}
				</a>
			{{end}}
			{{if .Repository.UnitEnabled $.UnitTypeIssues}}
				<a href="#closed-issues" class="ui attached segment text center">
					<i class="text red octicon octicon-issue-closed"></i> <strong>{{.Pulse.ClosedIssueCount}}</strong><br>
					{{.i18n.Tr "repo.pulse.closed_issues_count"}}
				</a>
				<a href="#new-issues" class="ui attached segment text center">
					<i class="text green octicon octicon-issue-opened"></i> <strong>{{.Pulse.OpenedIssueCount}}</strong><br>
					{{.i18n.Tr "repo.pulse.new_issues_count"}}
				</a>
			{{end}}
		</div>
		{{end}}

		{{if gt .Pulse.MergedPRCount 0}}
			<h4 class="ui horizontal divider header" id="merged-pull-requests">
				<i class="text octicon octicon-git-pull-request"></i>
				{{.i18n.Tr "repo.pulse.merged_prs_title" .Pulse.MergedPRCount .Pulse.MergedPRAuthorCount | Safe}}
			</h4>
			<div class="list">
				{{range .Pulse.MergedPRs}}
					<p class="desc">
						<div class="ui purple label">{{$.i18n.Tr "repo.pulse.merged_prs_label"}}</div>
						#{{.Index}} <a class="title has-emoji" href="{{$.Repository.HTMLURL}}/pulls/{{.Index}}">{{.Issue.Title}}</a>
						{{TimeSince .Merged $.Lang}}
					</p>
				{{end}}
			</div>
		{{end}}

		{{if gt .Pulse.OpenedPRCount 0}}
			<h4 class="ui horizontal divider header" id="proposed-pull-requests">
				<i class="text octicon octicon-git-branch"></i>
				{{.i18n.Tr "repo.pulse.opened_prs_title" .Pulse.OpenedPRCount .Pulse.OpenedPRAuthorCount | Safe}}
			</h4>
			<div class="list">
				{{range .Pulse.OpenedPRs}}
					<p class="desc">
						<div class="ui green label">{{$.i18n.Tr "repo.pulse.opened_prs_label"}}</div>
						#{{.Index}} <a class="title has-emoji" href="{{$.Repository.HTMLURL}}/pulls/{{.Index}}">{{.Issue.Title}}</a>
						{{TimeSince .Issue.Created $.Lang}}
					</p>
				{{end}}
			</div>
		{{end}}

		{{if gt .Pulse.ClosedIssueCount 0}}
			<h4 class="ui horizontal divider header" id="closed-issues">
				<i class="text octicon octicon-issue-closed"></i>
				{{.i18n.Tr "repo.pulse.closed_issues_title" .Pulse.ClosedIssueCount .Pulse.ClosedIssueAuthorCount | Safe}}
			</h4>
			<div class="list">
				{{range .Pulse.ClosedIssues}}
					<p class="desc">
						<div class="ui red label">{{$.i18n.Tr "repo.pulse.closed_issue_label"}}</div>
						#{{.Index}} <a class="title has-emoji" href="{{$.Repository.HTMLURL}}/issues/{{.Index}}">{{.Title}}</a>
						{{TimeSince .Updated $.Lang}}
					</p>
				{{end}}
			</div>
		{{end}}

		{{if gt .Pulse.OpenedIssueCount 0}}
			<h4 class="ui horizontal divider header" id="new-issues">
				<i class="text octicon octicon-issue-opened"></i>
				{{.i18n.Tr "repo.pulse.new_issues_title" .Pulse.OpenedIssueCount .Pulse.OpenedIssueAuthorCount | Safe}}
			</h4>
			<div class="list">
				{{range .Pulse.OpenedIssues}}
					<p class="desc">
						<div class="ui green label">{{$.i18n.Tr "repo.pulse.new_issue_label"}}</div>
						#{{.Index}} <a class="title has-emoji" href="{{$.Repository.HTMLURL}}/issues/{{.Index}}">{{.Title}}</a>
						{{TimeSince .Created $.Lang}}
					</p>
				{{end}}
			</div>
		{{end}}

		{{if gt .Pulse.UnresolvedIssueCount 0}}
			<h4 class="ui horizontal divider header" id="unresolved-conversations">
				<i class="text octicon octicon-comment-discussion"></i>
				{{.i18n.Tr "repo.pulse.unresolved_conv_title" .Pulse.UnresolvedIssueCount | Safe}}
			</h4>
			<div class="text center desc">
				{{.i18n.Tr "repo.pulse.unresolved_conv_desc"}}
			</div>
			<div class="list">
				{{range .Pulse.UnresolvedIssues}}
					<p class="desc">
						<div class="ui green label">{{$.i18n.Tr "repo.pulse.unresolved_conv_label"}}</div>
						#{{.Index}}
						{{if .IsPull}}
						<a class="title has-emoji" href="{{$.Repository.HTMLURL}}/pulls/{{.Index}}">{{.Title}}</a>
						{{else}}
						<a class="title has-emoji" href="{{$.Repository.HTMLURL}}/issues/{{.Index}}">{{.Title}}</a>
						{{end}}
						{{TimeSince .Updated $.Lang}}
					</p>
				{{end}}
			</div>
		{{end}}
	</div>
</div>
{{template "base/footer" .}}
