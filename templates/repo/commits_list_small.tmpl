{{ $r:= List $.comment.Commits}}
{{ $index := 0}}
<div class="timeline-item commits-list">
{{range $r}}
	{{ $tag := printf "%s-%d" $.comment.HashTag $index }}
	{{ $index = Add $index 1}}
	<div class="singular-commit" id="{{$tag}}">
		<span class="badge badge-commit">{{svg "octicon-git-commit" 16}}</span>
		{{if .User}}
			<a class="ui avatar image" href="{{AppSubUrl}}/{{.User.Name}}"><img src="{{.User.RelAvatarLink}}" alt=""/></a>
		{{else}}
			<img class="ui avatar image" src="{{AvatarLink .Author.Email}}" alt=""/>
		{{end}}

		<span class="ui float right shabox">
			{{if eq (CommitType .) "SignCommitWithStatuses"}}
        		{{template "repo/commit_status" .Status}}
        	{{end}}
			{{$class := "ui sha label"}}
			{{if .Signature}}
				{{$class = (printf "%s%s" $class " isSigned")}}
				{{if .Verification.Verified}}
					{{if eq .Verification.TrustStatus "trusted"}}
						{{$class = (printf "%s%s" $class " isVerified")}}
					{{else if eq .Verification.TrustStatus "untrusted"}}
						{{$class = (printf "%s%s" $class " isVerifiedUntrusted")}}
					{{else}}
						{{$class = (printf "%s%s" $class " isVerifiedUnmatched")}}
					{{end}}
				{{else if .Verification.Warning}}
					{{$class = (printf "%s%s" $class " isWarning")}}
				{{end}}
			{{end}}
			{{if $.comment.Issue.PullRequest.BaseRepo.Name}}
				<a href="{{AppSubUrl}}/{{$.comment.Issue.PullRequest.BaseRepo.OwnerName}}/{{$.comment.Issue.PullRequest.BaseRepo.Name}}/commit/{{.ID}}" rel="nofollow" class="{{$class}}">
			{{else}}
				<span class="{{$class}}">
			{{end}}
			<span class="shortsha">{{ShortSha .ID.String}}</span>
			{{if .Signature}}
				<div class="ui detail icon button">
					{{if .Verification.Verified}}
						<div title="{{if eq .Verification.TrustStatus "trusted"}}{{else if eq .Verification.TrustStatus "untrusted"}}{{$.root.i18n.Tr "repo.commits.signed_by_untrusted_user"}}: {{else}}{{$.root.i18n.Tr "repo.commits.signed_by_untrusted_user_unmatched"}}: {{end}}{{.Verification.Reason}}">
						{{if ne .Verification.SigningUser.ID 0}}
							<i class="lock icon"></i>
							<img class="ui signature avatar image" src="{{.Verification.SigningUser.RelAvatarLink}}" />
						{{else}}
							<i title="{{.Verification.Reason}}" class="icons">
								<i class="lock icon"></i>
								<i class="tiny inverted cog icon centerlock"></i>
							</i>
							<img class="ui signature avatar image" src="{{AvatarLink .Verification.SigningEmail}}" />
						{{end}}
						</div>
					{{else}}
						<i title="{{$.root.i18n.Tr .Verification.Reason}}" class="unlock icon"></i>
					{{end}}
				</div>
			{{end}}
			{{if $.comment.Issue.PullRequest.BaseRepo.Name}}
				</a>
			{{else}}
				</span>
			{{end}}
		</span>

		<span class="message-wrapper">
			{{ $commitLink:= printf "%s/%s/%s/commit/%s" AppSubUrl  $.comment.Issue.PullRequest.BaseRepo.OwnerName $.comment.Issue.PullRequest.BaseRepo.Name .ID }}
			<span class="mono commit-summary{{if gt .ParentCount 1}} grey text{{end}}" title="{{.Summary}}">{{RenderCommitMessageLinkSubject .Message ($.comment.Issue.PullRequest.BaseRepo.Link|Escape) $commitLink $.comment.Issue.PullRequest.BaseRepo.ComposeMetas}}</span>
		</span>
		{{if IsMultilineCommitMessage .Message}}
			<button class="basic compact mini ui icon button commit-button"><i class="ellipsis horizontal icon"></i></button>
		{{end}}
		{{if IsMultilineCommitMessage .Message}}
			<pre class="commit-body" style="display: none;">{{RenderCommitBody .Message ($.comment.Issue.PullRequest.BaseRepo.Link|Escape) $.comment.Issue.PullRequest.BaseRepo.ComposeMetas}}</pre>
		{{end}}
	</div>
{{end}}
</div>
