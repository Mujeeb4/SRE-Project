{{template "base/head" .}}
<div role="main" aria-label="{{.Title}}" class="page-content organization milestone">
	{{template "org/header" .}}
	<div class="ui container">
		<div class="tw-flex">
			<h1 class="tw-mb-3">{{.Milestone.Name}}</h1>
				<div class="text right tw-flex-1">
					{{if .CanWriteMilestone}}
						{{if .Milestone.IsClosed}}
							<a class="ui primary button link-action" href data-url="{{$.Link}}/open">{{ctx.Locale.Tr "repo.milestones.open"}}
							</a>
						{{else}}
							<a class="ui red button link-action" href data-url="{{$.Link}}/close">{{ctx.Locale.Tr "repo.milestones.close"}}
							</a>
						{{end}}
						<a class="ui button" href="{{$.Link}}/{{.ID}}/edit">{{ctx.Locale.Tr "repo.milestones.edit"}}</a>
					{{end}}
				</div>
		</div>
			{{if .Milestone.RenderedContent}}
			<div class="markup content tw-mb-4">
					{{.Milestone.RenderedContent}}
			</div>
			{{end}}
			<div class="tw-flex tw-flex-col tw-gap-2">
				<progress class="milestone-progress-big" value="{{.Milestone.Completeness}}" max="100"></progress>
				<div class="tw-flex tw-gap-4">
					<div classs="tw-flex tw-items-center">
						{{$closedDate:= TimeSinceUnix .Milestone.ClosedDateUnix ctx.Locale}}
						{{if .IsClosed}}
							{{svg "octicon-clock"}} {{ctx.Locale.Tr "repo.milestones.closed" $closedDate}}
						{{else}}
							{{if .Milestone.DeadlineString}}
								<span{{if .IsOverdue}} class="text red"{{end}}>
									{{svg "octicon-calendar"}}
									{{DateTime "short" .Milestone.DeadlineString}}
								</span>
							{{else}}
								{{svg "octicon-calendar"}}
								{{ctx.Locale.Tr "repo.milestones.no_due_date"}}
							{{end}}
						{{end}}
					</div>
					<div class="tw-mr-3">{{ctx.Locale.Tr "repo.milestones.completeness" .Milestone.Completeness}}</div>
					{{if .TotalTrackedTime}}
						<div data-tooltip-content='{{ctx.Locale.Tr "tracked_time_summary"}}'>
							{{svg "octicon-clock"}}
							{{.TotalTrackedTime | Sec2Time}}
						</div>
					{{end}}
				</div>
			</div>
			<div class="divider"></div>
			{{template "repo/issue/filters" .}}
			{{template "shared/issuelist" dict "." . "listType" "milestone"}}
	</div>
</div>
{{template "base/footer" .}}
